<!DOCTYPE html>
<html lang="en">
<head>
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NHMP9QC03E"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-NHMP9QC03E');
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    ...
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABC Analysis Automator - Inventory Classification Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #0f172a 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            background: linear-gradient(to right, #60a5fa, #34d399);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header p {
            font-size: 1.2em;
            color: #93c5fd;
        }

        .upload-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .upload-area {
            border: 3px dashed #60a5fa;
            border-radius: 15px;
            padding: 60px 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(59, 130, 246, 0.1);
        }

        .upload-area:hover {
            background: rgba(59, 130, 246, 0.2);
            border-color: #34d399;
        }

        .upload-area.dragover {
            background: rgba(52, 211, 153, 0.2);
            border-color: #34d399;
        }

        .upload-icon {
            font-size: 4em;
            margin-bottom: 20px;
        }

        #fileInput {
            display: none;
        }

        .btn {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            margin: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
        }

        .format-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .info-box {
            background: rgba(30, 58, 138, 0.3);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid rgba(96, 165, 250, 0.3);
        }

        .info-box h3 {
            color: #60a5fa;
            margin-bottom: 15px;
        }

        .info-box code {
            display: block;
            background: rgba(15, 23, 42, 0.6);
            padding: 15px;
            border-radius: 8px;
            color: #34d399;
            font-size: 0.9em;
            line-height: 1.6;
            margin: 10px 0;
        }

        .error {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
            color: #fca5a5;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .dashboard {
            display: none;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(30, 58, 138, 0.3));
            padding: 30px;
            border-radius: 15px;
            border: 1px solid rgba(96, 165, 250, 0.3);
            transition: transform 0.3s;
        }

        .metric-card:hover {
            transform: translateY(-5px);
        }

        .metric-label {
            color: #93c5fd;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            background: linear-gradient(to right, #60a5fa, #34d399);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .metric-sub {
            color: #cbd5e1;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chart-container h3 {
            margin-bottom: 20px;
            color: #60a5fa;
        }

        .insights {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .insight-card {
            background: rgba(30, 58, 138, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid;
        }

        .insight-card.cat-a { border-color: #ef4444; }
        .insight-card.cat-b { border-color: #f59e0b; }
        .insight-card.cat-c { border-color: #10b981; }

        .table-container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        th {
            background: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
            font-weight: bold;
        }

        tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .category-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
        }

        .cat-a-badge { background: #ef4444; }
        .cat-b-badge { background: #f59e0b; }
        .cat-c-badge { background: #10b981; }

        .actions {
            text-align: center;
            margin: 30px 0;
        }

        @media (max-width: 768px) {
            .format-info, .charts-grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä ABC Analysis Automator</h1>
            <p>Intelligent Inventory Classification System</p>
        </div>

        <div class="upload-section">
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">üìÅ</div>
                <h2>Drop CSV File Here or Click to Upload</h2>
                <p style="color: #93c5fd; margin-top: 10px;">Required columns: Part Name, Unit Price, Annual Consumption</p>
                <input type="file" id="fileInput" accept=".csv">
            </div>

            <div class="format-info">
                <div class="info-box">
                    <h3>üìã Required Format</h3>
                    <code>Part Name,Unit Price,Annual Consumption<br>Bearing XYZ,150,2000<br>Bolt Type A,5,15000<br>Motor 5HP,3500,500</code>
                    <button class="btn btn-success" onclick="downloadTemplate()">‚¨áÔ∏è Download Template</button>
                </div>
                <div class="info-box">
                    <h3>‚ÑπÔ∏è How It Works</h3>
                    <p style="line-height: 1.8; color: #cbd5e1;">
                        1. Upload your inventory CSV file<br>
                        2. System calculates total value automatically<br>
                        3. Items categorized into A, B, C classes<br>
                        4. Get instant analytics and insights<br>
                        5. Export detailed results
                    </p>
                </div>
            </div>

            <div class="actions">
                <button class="btn btn-secondary" onclick="loadSampleData()">üî¨ Try with Sample Data</button>
            </div>

            <div id="error" class="error" style="display: none;"></div>
        </div>

        <div class="dashboard" id="dashboard">
            <div class="metrics" id="metrics"></div>

            <div class="charts-grid">
                <div class="chart-container">
                    <h3>üìä Value Distribution by Category</h3>
                    <canvas id="pieChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>üìà Item Count by Category</h3>
                    <canvas id="barChart"></canvas>
                </div>
            </div>

            <div class="insights" id="insights"></div>

            <div class="table-container">
                <h3 style="color: #60a5fa; margin-bottom: 20px;">üìã Detailed Item Analysis</h3>
                <div class="actions" style="margin-bottom: 20px;">
                    <button class="btn btn-success" onclick="exportResults()">‚¨áÔ∏è Export Results (CSV)</button>
                    <button class="btn btn-secondary" onclick="resetTool()">üîÑ Analyze New File</button>
                </div>
                <table id="resultsTable"></table>
            </div>
        </div>
    </div>

    <script>
        let analysisData = null;

        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const errorDiv = document.getElementById('error');

        // Upload area interactions
        uploadArea.addEventListener('click', () => fileInput.click());

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file) handleFile(file);
        });

        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) handleFile(file);
        });

        function handleFile(file) {
            if (!file.name.endsWith('.csv')) {
                showError('Please upload a CSV file');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    processCSV(e.target.result);
                } catch (err) {
                    showError(err.message);
                }
            };
            reader.readAsText(file);
        }

        function processCSV(content) {
            const lines = content.trim().split('\n');
            const headers = lines[0].split(',').map(h => h.trim());

            // Validate headers
            const requiredHeaders = ['Part Name', 'Unit Price', 'Annual Consumption'];
            const hasRequired = requiredHeaders.every(h => 
                headers.some(header => header.toLowerCase() === h.toLowerCase())
            );

            if (!hasRequired) {
                throw new Error('CSV must contain: Part Name, Unit Price, Annual Consumption');
            }

            // Find column indices
            const indices = {
                name: headers.findIndex(h => h.toLowerCase() === 'part name'),
                price: headers.findIndex(h => h.toLowerCase() === 'unit price'),
                consumption: headers.findIndex(h => h.toLowerCase() === 'annual consumption')
            };

            // Parse data
            const items = lines.slice(1).map((line, idx) => {
                const values = line.split(',').map(v => v.trim());
                const price = parseFloat(values[indices.price]) || 0;
                const consumption = parseFloat(values[indices.consumption]) || 0;
                const totalValue = price * consumption;

                return {
                    id: idx,
                    name: values[indices.name] || `Item ${idx + 1}`,
                    unitPrice: price,
                    annualConsumption: consumption,
                    totalValue: totalValue
                };
            }).filter(item => item.totalValue > 0);

            if (items.length === 0) {
                throw new Error('No valid data found in CSV');
            }

            performABCAnalysis(items);
        }

        function performABCAnalysis(items) {
            // Sort by total value descending
            items.sort((a, b) => b.totalValue - a.totalValue);

            // Calculate cumulative percentages
            const totalValue = items.reduce((sum, item) => sum + item.totalValue, 0);
            let cumulative = 0;

            items.forEach(item => {
                cumulative += item.totalValue;
                item.cumulativePercentage = (cumulative / totalValue) * 100;
                item.valuePercentage = (item.totalValue / totalValue) * 100;

                // ABC Classification
                if (item.cumulativePercentage <= 70) {
                    item.category = 'A';
                } else if (item.cumulativePercentage <= 90) {
                    item.category = 'B';
                } else {
                    item.category = 'C';
                }
            });

            // Calculate category stats
            const stats = {
                A: { count: 0, value: 0, items: [] },
                B: { count: 0, value: 0, items: [] },
                C: { count: 0, value: 0, items: [] }
            };

            items.forEach(item => {
                stats[item.category].count++;
                stats[item.category].value += item.totalValue;
                stats[item.category].items.push(item);
            });

            Object.keys(stats).forEach(cat => {
                stats[cat].percentage = (stats[cat].value / totalValue) * 100;
                stats[cat].countPercentage = (stats[cat].count / items.length) * 100;
            });

            analysisData = { items, stats, totalValue, totalItems: items.length };
            displayResults();
        }

        function displayResults() {
            errorDiv.style.display = 'none';
            document.querySelector('.upload-section').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';

            displayMetrics();
            displayCharts();
            displayInsights();
            displayTable();
        }

        function displayMetrics() {
            const { stats, totalValue, totalItems } = analysisData;
            const metricsHTML = `
                <div class="metric-card">
                    <div class="metric-label">Total Items</div>
                    <div class="metric-value">${totalItems}</div>
                    <div class="metric-sub">SKUs in inventory</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Total Value</div>
                    <div class="metric-value">‚Çπ${(totalValue/1000).toFixed(0)}K</div>
                    <div class="metric-sub">${formatCurrency(totalValue)}</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Category A Items</div>
                    <div class="metric-value">${stats.A.count}</div>
                    <div class="metric-sub">${stats.A.percentage.toFixed(1)}% of total value</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Category B Items</div>
                    <div class="metric-value">${stats.B.count}</div>
                    <div class="metric-sub">${stats.B.percentage.toFixed(1)}% of total value</div>
                </div>
            `;
            document.getElementById('metrics').innerHTML = metricsHTML;
        }

        function displayCharts() {
            const { stats } = analysisData;

            // Pie Chart
            new Chart(document.getElementById('pieChart'), {
                type: 'pie',
                data: {
                    labels: ['Category A', 'Category B', 'Category C'],
                    datasets: [{
                        data: [stats.A.percentage, stats.B.percentage, stats.C.percentage],
                        backgroundColor: ['#ef4444', '#f59e0b', '#10b981']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { labels: { color: '#fff' } }
                    }
                }
            });

            // Bar Chart
            new Chart(document.getElementById('barChart'), {
                type: 'bar',
                data: {
                    labels: ['Category A', 'Category B', 'Category C'],
                    datasets: [{
                        label: 'Item Count',
                        data: [stats.A.count, stats.B.count, stats.C.count],
                        backgroundColor: ['#ef4444', '#f59e0b', '#10b981']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { labels: { color: '#fff' } }
                    },
                    scales: {
                        y: { 
                            ticks: { color: '#fff' },
                            grid: { color: 'rgba(255,255,255,0.1)' }
                        },
                        x: { 
                            ticks: { color: '#fff' },
                            grid: { color: 'rgba(255,255,255,0.1)' }
                        }
                    }
                }
            });
        }

        function displayInsights() {
            const { stats } = analysisData;
            const insightsHTML = `
                <h3 style="color: #60a5fa; margin-bottom: 20px;">üí° Key Insights</h3>
                <div class="insight-card cat-a">
                    <strong style="color: #fca5a5;">üéØ Category A - Critical Items</strong>
                    <p style="margin-top: 10px; color: #cbd5e1;">${stats.A.count} items (${stats.A.countPercentage.toFixed(1)}% of inventory) represent ${stats.A.percentage.toFixed(1)}% of total value. These require tight control, accurate records, and frequent monitoring.</p>
                </div>
                <div class="insight-card cat-b">
                    <strong style="color: #fde68a;">‚ö†Ô∏è Category B - Important Items</strong>
                    <p style="margin-top: 10px; color: #cbd5e1;">${stats.B.count} items (${stats.B.countPercentage.toFixed(1)}% of inventory) represent ${stats.B.percentage.toFixed(1)}% of total value. Moderate control and good records needed with regular review cycles.</p>
                </div>
                <div class="insight-card cat-c">
                    <strong style="color: #6ee7b7;">‚úì Category C - Standard Items</strong>
                    <p style="margin-top: 10px; color: #cbd5e1;">${stats.C.count} items (${stats.C.countPercentage.toFixed(1)}% of inventory) represent ${stats.C.percentage.toFixed(1)}% of total value. Simple controls and periodic review sufficient.</p>
                </div>
            `;
            document.getElementById('insights').innerHTML = insightsHTML;
        }

        function displayTable() {
            const { items } = analysisData;
            let tableHTML = `
                <thead>
                    <tr>
                        <th>Part Name</th>
                        <th style="text-align: right;">Unit Price</th>
                        <th style="text-align: right;">Annual Qty</th>
                        <th style="text-align: right;">Total Value</th>
                        <th style="text-align: right;">Value %</th>
                        <th style="text-align: center;">Category</th>
                    </tr>
                </thead>
                <tbody>
            `;

            items.slice(0, 20).forEach(item => {
                const badgeClass = `cat-${item.category.toLowerCase()}-badge`;
                tableHTML += `
                    <tr>
                        <td>${item.name}</td>
                        <td style="text-align: right;">${formatCurrency(item.unitPrice)}</td>
                        <td style="text-align: right;">${item.annualConsumption.toLocaleString()}</td>
                        <td style="text-align: right;"><strong>${formatCurrency(item.totalValue)}</strong></td>
                        <td style="text-align: right;">${item.valuePercentage.toFixed(2)}%</td>
                        <td style="text-align: center;"><span class="category-badge ${badgeClass}">${item.category}</span></td>
                    </tr>
                `;
            });

            tableHTML += '</tbody>';
            document.getElementById('resultsTable').innerHTML = tableHTML;

            if (items.length > 20) {
                document.getElementById('resultsTable').innerHTML += `
                    <tfoot><tr><td colspan="6" style="text-align: center; color: #93c5fd; padding: 20px;">
                        Showing top 20 of ${items.length} items. Download full report for complete analysis.
                    </td></tr></tfoot>
                `;
            }
        }

        function formatCurrency(value) {
            return new Intl.NumberFormat('en-IN', {
                style: 'currency',
                currency: 'INR',
                maximumFractionDigits: 0
            }).format(value);
        }

        function exportResults() {
            const { items } = analysisData;
            let csv = 'Part Name,Unit Price,Annual Consumption,Total Value,Value %,Cumulative %,ABC Category\n';
            items.forEach(item => {
                csv += `"${item.name}",${item.unitPrice},${item.annualConsumption},${item.totalValue.toFixed(2)},${item.valuePercentage.toFixed(2)},${item.cumulativePercentage.toFixed(2)},${item.category}\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `abc_analysis_results_${new Date().toISOString().slice(0,10)}.csv`;
            a.click();
        }

        function downloadTemplate() {
            const template = 'Part Name,Unit Price,Annual Consumption\nBearing XYZ,150,2000\nBolt Type A,5,15000\nMotor 5HP,3500,500\nScrew M6,0.5,50000\nPump Assembly,8000,200';
            const blob = new Blob([template], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'abc_analysis_template.csv';
            a.click();
        }

        function loadSampleData() {
            const sampleCSV = `Part Name,Unit Price,Annual Consumption
Industrial Motor 10HP,45000,120
Bearing SKF 6205,850,2500
Hydraulic Pump Assembly,125000,45
Steel Bolt M12x80,15,25000
Conveyor Belt 1200mm,32000,85
Pressure Gauge 0-10bar,1200,450
Safety Valve 2 inch,8500,180
Gearbox Reducer 1:40,95000,35
Control Panel Assembly,150000,28
Pneumatic Cylinder 50mm,12000,220`;
            processCSV(sampleCSV);
        }

        function resetTool() {
            location.reload();
        }

        function showError(message) {
            errorDiv.textContent = '‚ùå Error: ' + message;
            errorDiv.style.display = 'block';
        }
    </script>
</body>
</html>